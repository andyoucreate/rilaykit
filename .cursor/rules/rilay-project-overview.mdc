---
description: 
globs: 
alwaysApply: false
---
# Rilay Project Overview

## ğŸ¯ Purpose
Rilay is a next-generation React form library focused on modularity, type safety, and extensibility. It provides a complete ecosystem for building complex forms and multi-step workflows with validation, conditional logic, and custom rendering.

## ğŸ“ Architecture

### Monorepo Structure
```
rilay/
â”œâ”€â”€ packages/              # Core packages
â”‚   â”œâ”€â”€ core/             # Type definitions & config system
â”‚   â”œâ”€â”€ form-builder/     # Form creation & management
â”‚   â””â”€â”€ workflow/         # Multi-step workflow system
â””â”€â”€ apps/
    â””â”€â”€ playground/       # Testing environment
```

### Package Dependencies
- **@rilaykit/core**: Foundation layer with types and [RilayConfig.ts](mdc:packages/core/src/config/RilayConfig.ts)
- **@rilaykit/forms**: Uses core, provides [FormBuilder.ts](mdc:packages/form-builder/src/builders/FormBuilder.ts) and components
- **@rilaykit/workflow**: Uses core, provides workflow orchestration
- **playground**: Demo app using all packages

## ğŸ”§ Core Concepts

### 1. RilayConfig System
- **Central registry** for component configurations
- **Type-safe component registration** with `addComponent()`
- **Custom renderers** for form structure (row, body, submit button)
- **Validation integration** with Zod/custom validators

### 2. FormBuilder Pattern
- **Fluent API** for form construction: `FormBuilder.create().addField().addRowFields().build()`
- **Matrix layout** support (max 3 fields per row)
- **Field validation** with async support and debouncing
- **Conditional logic** for show/hide/disable/require

### 3. Component System
- **Strongly typed** components with `ComponentRenderProps<TProps>`
- **Flexible rendering** via custom renderer functions
- **Built-in validation** integration per field
- **Error & warning** display with touch state

### 4. Form State Management
- **Centralized state** via [FormProvider.tsx](mdc:packages/form-builder/src/components/FormProvider.tsx)
- **Real-time validation** with smart triggering:
  - `validateOnChange`: Explicit configuration
  - **Auto-validation** when field has errors or is touched
  - `validateOnBlur`: Always validates when user leaves field
- **Error clearing** when user starts correcting input

## ğŸš€ Usage Patterns

### Basic Form Creation
```typescript
const config = RilayConfig.create()
  .addComponent('text', { type: 'input', renderer: TextInput })
  .addComponent('email', { type: 'input', renderer: EmailInput });

const form = FormBuilder.create(config)
  .addField('name', 'text', { label: 'Name' })
  .addField('email', 'email', { label: 'Email' })
  .build();
```

### Form Rendering
```tsx
<Form formConfig={form} onSubmit={handleSubmit}>
  <FormBody />
  <FormSubmitButton />
</Form>
```

## ğŸ“‹ Key Files

### Core Package
- [packages/core/src/types/index.ts](mdc:packages/core/src/types/index.ts): All TypeScript definitions
- [packages/core/src/config/RilayConfig.ts](mdc:packages/core/src/config/RilayConfig.ts): Configuration management
- [packages/core/src/validation/validators.ts](mdc:packages/core/src/validation/validators.ts): Zod integration helpers

### Form Builder Package
- [packages/form-builder/src/builders/FormBuilder.ts](mdc:packages/form-builder/src/builders/FormBuilder.ts): Form construction API
- [packages/form-builder/src/components/FormProvider.tsx](mdc:packages/form-builder/src/components/FormProvider.tsx): State management
- [packages/form-builder/src/components/FormField.tsx](mdc:packages/form-builder/src/components/FormField.tsx): Individual field rendering

### Playground
- [apps/playground/src/pages/form-test.tsx](mdc:apps/playground/src/pages/form-test.tsx): Complete form example
- [apps/playground/src/pages/workflow-test.tsx](mdc:apps/playground/src/pages/workflow-test.tsx): Workflow demonstration

## ğŸ›ï¸ Development Workflow

### Build System
- **Turbo monorepo** with [turbo.json](mdc:turbo.json)
- **pnpm workspaces** via [pnpm-workspace.yaml](mdc:pnpm-workspace.yaml)
- **TypeScript strict mode** with shared [tsconfig.json](mdc:tsconfig.json)
- **Biome** for linting/formatting via [biome.json](mdc:biome.json)

### Scripts
- `pnpm dev`: Start development server
- `pnpm build`: Build all packages
- `pnpm test`: Run tests across packages
- `pnpm type-check`: TypeScript validation

## ğŸ” Key Features

### Validation System
- **Async validation** with debouncing
- **Context-aware validators** (form data, field props, touched state)
- **Error & warning** separation
- **Smart triggering**: Validates when field is touched or has errors

### Form State Intelligence
- **Automatic error clearing** when user starts typing
- **Touch-aware validation** - validates on change after blur
- **Conditional rendering** based on form data
- **Real-time form state** (dirty, valid, submitting)

### Extensibility
- **Custom component renderers** for any input type
- **Custom structural renderers** (row, body, submit button layouts)
- **Plugin system** for workflows
- **Type-safe configuration** throughout

## ğŸ› ï¸ Common Tasks

### Adding New Component Type
1. Define props interface
2. Create renderer component  
3. Register with `config.addComponent()`
4. Add to FormBuilder usage

### Custom Validation
1. Use `createZodValidator()` for Zod schemas
2. Or create custom `ValidatorFunction`
3. Configure debouncing, timing options

### Workflow Integration
1. Use `@rilaykit/workflow` package
2. Define steps with form configurations
3. Handle step transitions and persistence

The project emphasizes type safety, modularity, and developer experience while providing powerful form building capabilities.
